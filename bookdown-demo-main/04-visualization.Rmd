# Visualizations

## Visualization 1: Number of new case in each month

First, let's see what's the distribution of monthly case increased look like. The first three visualizations we have here is are density plots that count the frequencies of monthly case increases, not relating to time or state. If we look at the Unites States as a whole, we see that the majority of the number of new cases in one month for the whole country is around 100,000.

```{r}
covid19_month %>%
  ggplot(aes(x = cases)) +
  geom_density() +
  labs(x = "Number of new cases in one month", y = "Count", title = "Distribution of number of new cases of US in one month") +
  theme(plot.title = element_text(hjust = 0.5))
```

We can also look at individual state's distribution. The state of Minnesota and the state of California have similar distributions, but Minnesota has significantly fewer cases, probably due to less population.

```{r}
covid19_month %>%
  filter(state == "Minnesota") %>%
  ggplot(aes(x = cases)) +
  geom_density() + 
  labs(x = "Number of new cases in one month", y = "Count", title = "Distribution of number of new cases of MN in one month") +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
covid19_month %>%
  filter(state == "California") %>%
  ggplot(aes(x = cases)) +
  geom_density() +
  labs(x = "Number of new cases in one month", y = "Count", title = "Distribution of number of new cases of CA in one month") +
  theme(plot.title = element_text(hjust = 0.5))
```

Next, we are trying to find a regression model that best fits the distribution plotted above. We choose negative binomial model because it is less rigid with a mean parameter and reciprocal dispersion parameter. Also, the response variable is a number, a quantitative value. So we would choose negative binomial to give our model more flexibility and it turns out in our later MCMC simulation that negative binomial is actually the best model.

## Visualization 2: Time and State

Of course, we are also able to show how the number of new cases for each month varies from state to state and time to time:

**For US as the whole**

```{r}
covid19_month %>% 
  dplyr::group_by(Date) %>%
  dplyr::summarize(cases = sum(cases)) %>%
  ggplot(aes(x = Date, y = cases)) +
  geom_line() + 
  labs(x = "Date", y = "Number of new cases in each month", title = "Number of new cases of US in one month changes over time") +
  theme(plot.title = element_text(hjust = 0.5))
```

**For individual states**

```{r}
covid19_month %>%
  ggplot(aes(x = Date, y = cases, color = state)) +
  geom_line() + 
  labs(x = "Date", y = "Number of new cases in each month", title = "Number of new cases of states in one month changes over time") +
  theme(legend.position = "none", plot.title = element_text(hjust = 0.5))
```

**For several states in details**

We filter out the states with most increases: California, Florida, New York and Texas.

```{r}
covid19_month %>%
  filter(state == "California" || state == "Florida" || state == "New York" || state == "Texas") %>%
  ggplot(aes(x = Date, y = cases, color = state)) +
  geom_line() +
  labs(x = "Date", y = "Number of new cases in each month", color = "State", title = "Number of new cases of CA, FL, NY, TX in one month changes over time") +
  theme(plot.title = element_text(hjust = 0.5))
```

From the graph, we see that the number of new cases in each month is not linearly related with time, so it's not reasonable to use a linear model. Also, from the next chart, monthly increases also fluctuate with state: we see that some states have significantly more increases than other states and different states have somewhere different patterns as well. What's more, even though the number of new cases each month is not linearly related with time, we do observe a pattern if we categorize time by season, and we decide to explore on that.

## Visualization 3: Season

Next, we plot new cases with season: winter has the most case increase while spring has the least.

```{r}
covid19_month %>%
  dplyr::group_by(season) %>%
  dplyr::summarize(cases_mean = mean(cases)) %>%
  ggplot() +
  geom_bar(mapping = aes(x = season, y = cases_mean), stat = "identity") +
  labs(x = "Season", y = "Mean of number of new cases in each month", title = "Number of new cases of US in one month changes over seasons") +
  theme(plot.title = element_text(hjust = 0.5))
``` 

Thus, besides state, we pick season as another independent variable in our model.


## Visualization 4: Lagging varianbles

The three plots below are time lag plots. A lag is a fixed time displacement. In our case, we have a time displacement of 1, 3, and 6 months. The plots all exhibit a linear pattern. This shows that the data are strongly non-random and means that we are able to use a time series analysis to model the data and generate forecasts. Thus, in our final model, we also take these three lagging variables into considerations.

```{r}
covid19_month %>%
  ggplot(aes(x = log(cases), y = log(lag1))) +
  geom_point() +
  labs(x = "log(number of cases in one month)", y = "log(number of cases in the last month)", title = "How the number of cases in one month changes with that in the last month") +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
covid19_month %>%
  ggplot(aes(x = log(cases), y = log(lag3))) +
  geom_point()+
  labs(x = "log(number of cases in one month)", y = "log(number of cases three months ago)", title = "How the number of cases in one month changes with that three months ago") +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}
covid19_month %>%
  ggplot(aes(x = log(cases), y = log(lag6))) +
  geom_point()+
  labs(x = "log(number of cases in one month)", y = "log(number of cases half a year ago)", title = "How the number of cases in one month changes with that half a year ago") +
  theme(plot.title = element_text(hjust = 0.5))
```


